(this.webpackJsonpninjabook=this.webpackJsonpninjabook||[]).push([[0],{37:function(e,t,a){e.exports=a(80)},42:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(19),c=a.n(o),s=(a(42),a(9)),i=a(2),l=a(12),u=a(13),d=a(14),m=a.n(d),p=a(8),f=a.n(p),g="/api";b()&&(f.a.defaults.headers.common["x-auth-token"]=b());var h=b()?[{title:"... loading ...",author:Date(),id:Date.now()}]:[{title:"Please login to use",author:Date(),id:Date.now()}];function b(){return localStorage.getItem("token")}var E=Object(n.createContext)(),v=function(e){var t=Object(n.useState)(h),a=Object(i.a)(t,2),o=a[0],c=a[1];return r.a.createElement(E.Provider,{value:{bookList:o,dispatch:function(e){return function(e,t,a){var n=a.type,r=void 0===n?"":n,o=Object(u.a)(a,["type"]);if("initialize"===r);else{if("toggleStatus"===r){var c=e.find((function(e){return e.id===o.id}));return c.finish=!c.finish,t(Object(l.a)(e)),console.log(e.find((function(e){return e.id===o.id}))),f.a.put("".concat(g,"/booklist/updatebook/")+o.id,c).then((function(e){})).catch((function(a){var n=e.find((function(e){return e.id===o.id}));n.finish=!n.finish,t(Object(l.a)(e)),console.log(a.response.data),alert(a.response.data)}))}if(b()){if("deleteBook"===r){var s=e.filter((function(e){if(e.id!==o.id)return e}));return f.a.delete("".concat(g,"/booklist/deletebook/")+o.id).then((function(e){setTimeout((function(){t(s)}),500)})).catch((function(a){t(Object(l.a)(e)),console.log(a.response),alert(a.response.data)}))}if("logout"===r)t([]);else{if("cleanFinish"!==r)return"getBookList"===r?f.a.get("".concat(g,"/booklist/getbooklist")).then((function(e){var a=e.data.map((function(e){return{title:e.title,author:e.author,id:e.id,finish:e.finish}}));t(a)})).catch((function(e){console.log(e.response.data),alert(e.response.data)})):"addBook"===r?(t([].concat(Object(l.a)(e),[o.book]).sort((function(e,t){return e.id>=t.id?-1:1}))),f.a.post("".concat(g,"/booklist/addbook"),o.book).then((function(e){})).catch((function(a){t(e),console.log(a.response.data),alert(a.response.data)}))):e;t(e.filter((function(e){return!0!==e.finish})))}}else console.log("no tokens to perferm booklist functions")}}(o,c,e)}}},e.children)},k=a(10),O=function(){var e=function(){var e=localStorage.getItem("token");return Boolean(e)?m()(e):null}();return e?{username:e.username}:{username:""}}();function j(e){localStorage.setItem("token",e)}var w=Object(n.createContext)(),y=function(e){var t=Object(n.useState)(O),a=Object(i.a)(t,2),o=a[0],c=a[1];return r.a.createElement(w.Provider,{value:{user:o,dispatch:function(e){return function(e,t,a){var n=a.type,r=void 0===n?"":n,o=Object(u.a)(a,["type"]);if("removeLocalStorage"!==r)return"register"===r?f.a.post("".concat(g,"/user/register"),{username:o.username,password:o.password}).then((function(e){j(e.headers["x-auth-token"]),window.location.assign("/")})).catch((function(e){e.response.data.indexOf("user"),o.setErrMsg("username",e.response.data)})):"login"===r?f.a.post("".concat(g,"/user/login"),o).then((function(e){j(e.headers["x-auth-token"]),window.location.assign("/")})).catch((function(e){e.response.data.indexOf("user")>-1?o.setErrMsg("username",e.response.data):o.setErrMsg("password",e.response.data)})):e;localStorage.removeItem("token"),t(Object(k.a)({},e,{username:""}))}(o,c,e)}}},e.children)},x=function(e){var t=Object(n.useState)(""),a=Object(i.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(""),l=Object(i.a)(s,2),u=l[0],d=l[1],m=Object(n.useContext)(E).dispatch,p=Object(n.useContext)(w).user;return r.a.createElement(r.a.Fragment,null,p.username&&r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),m({type:"addBook",book:{title:o,author:u||Date().substr(0,24),id:Date.now(),finish:!1}}),c(""),d("")}},r.a.createElement("input",{placeholder:"title",type:"text",value:o,onChange:function(e){c(e.currentTarget.value)},required:!0}),r.a.createElement("input",{placeholder:"author",type:"text",value:u,onChange:function(e){d(e.currentTarget.value)}}),r.a.createElement("input",{type:"submit",value:"Add Book"})))},C=a(33),S=function(e){var t=e.book,a=(Object(u.a)(e,["book"]),0),o=!1,c=Object(n.useContext)(E).dispatch,s=Object(n.useState)(1),l=Object(i.a)(s,2),d=l[0],m=l[1],p=Object(n.useState)("auto"),f=Object(i.a)(p,2),g=f[0],h=f[1];return r.a.createElement(C.Spring,{from:{opacity:0,height:0},to:{opacity:d,height:g}},(function(e){return r.a.createElement("li",{className:t.finish?"done":"",style:e},r.a.createElement("button",{className:"deleteBtn",onClick:function(){a=setTimeout((function(){o||c({type:"toggleStatus",id:t.id}),o=!1}),200)},onDoubleClick:function(){clearTimeout(a),o=!0,m(0),h(0),c({type:"deleteBook",id:t.id})},onMouseEnter:function(e){e.currentTarget.parentNode.style="opacity:0.7;  text-decoration: line-through;"},onMouseOut:function(e){e.currentTarget.parentNode.style="opacity:1;  text-decoration: none;"}},"delete"),r.a.createElement("div",{className:t.finish?"title done":"title"},t.title,"  "),r.a.createElement("div",{className:t.finish?"author done":"author"},t.author," "))}))},T=function(e){var t=Object(n.useContext)(E),a=t.bookList,o=t.dispatch;return Object(n.useEffect)((function(){setTimeout((function(){o({type:"getBookList"})}),0)}),[]),r.a.createElement("div",{className:"book-list "},r.a.createElement(x,null),r.a.createElement("ul",null,a.map((function(t){return r.a.createElement(S,Object.assign({style:e},{key:t.id,book:t}))}))))},B=a(11),N=a(34),L=a.n(N),D=function(e){var t=Object(n.useContext)(E),a=t.bookList,o=t.dispatch,c=Object(n.useContext)(w),s=c.user,l=c.dispatch,u=Object(n.useState)(!1),d=Object(i.a)(u,2),m=d[0],p=d[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("nav",{className:"navbar",style:e},r.a.createElement("h1",null,s.username," Reading List..."),r.a.createElement("p",null,"Currently you have ",a.length," books to get through..."),r.a.createElement(L.a,{checked:m,onChange:function(){o(m?{type:"getBookList"}:{type:"cleanFinish"}),p(!m)},onColor:"#6d3d6d",offColor:"#6d3d6d",offHandleColor:"#eeeeee",onHandleColor:"#eeeeee",handleDiameter:30,uncheckedIcon:!1,checkedIcon:!1,boxShadow:"0px 1px 5px rgba(0, 0, 0, 0.6)",activeBoxShadow:"0px 0px 1px 10px rgba(0, 0, 0, 0.2)",height:1,width:48,className:"react-switch",id:"material-switch"})),r.a.createElement("button",null," ",r.a.createElement(B.b,{to:"/"},"home ")," "),!s.username&&r.a.createElement("button",null,"  ",r.a.createElement(B.b,{to:"/login"},"login  ")),!s.username&&r.a.createElement("button",null,"  ",r.a.createElement(B.b,{to:"/register"},"register  ")),s.username&&r.a.createElement("button",{style:{float:"right"},onClick:function(){o({type:"logout"}),l({type:"removeLocalStorage"}),window.location.assign("/")}},"logout"),Boolean(a.length)?r.a.createElement("p",null):r.a.createElement("p",{style:{textAlign:"center"}},"No books to read, Hello free time :)"))},F=a(16),I=a(17),R=a.n(I),M=function(e){var t=e.isRegisterForm,a=Object(n.useContext)(w),o=a.user,c=a.dispatch;o.username&&e.history.push("/");var s=Object(n.useState)({format:t?["text","password","password"]:["text","password"],data:t?{username:"",password:"",password2:""}:{username:"",password:""},error:t?{username:"",password:"",password2:""}:{username:"",password:""}}),u=Object(i.a)(s,2),d=u[0],m=u[1],p=function(e,t){m(Object(k.a)({},d,{error:Object(k.a)({},d.error,Object(F.a)({},e,t))}))},f=Object(n.useRef)(),g={username:R.a.string().min(3).required().label("Username"),password:R.a.string().min(3).required().label("Password"),password2:R.a.any().valid(d.data.password).required().options({language:{any:{allowOnly:"is not matching"}}}).label("Retyped Passwrod")},h=function(e){d.data[e.currentTarget.name]=e.currentTarget.value,d.error=b(e)?Object(k.a)({},d.error,Object(F.a)({},e.currentTarget.name,b(e))):(delete d.error[e.currentTarget.name],d.error),t&&"password"===e.currentTarget.name&&(d.error.password||(d.data.password===d.data.password2?delete d.error.password2:d.error.password2="Two passwords are not matching")),m(Object(k.a)({},d))},b=function(e){var t=R.a.validate(e.currentTarget.value,g[e.currentTarget.name],{abortEarly:!1});return t.error?t.error.details[0].message:null};return r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),c(Object(k.a)({type:t?"register":"login"},d.data,{setErrMsg:p}))}},Object.keys(d.data).map((function(e,t){return r.a.createElement("div",{className:"form-group",key:e},r.a.createElement("label",{htmlFor:e},Object(l.a)(e).shift().toLocaleUpperCase(),e.substr(1)),r.a.createElement("input",{id:e,className:"form-control",type:d.format[t],name:e,value:d.data[e],onChange:h}),r.a.createElement("div",null,d.error[e]))})),r.a.createElement("div",null,r.a.createElement("input",{ref:f,type:"submit",disabled:Boolean(Object.keys(d.error).length),value:t?"Regist":"Login"})))},P=function(e){return r.a.createElement(M,Object.assign({isRegisterForm:!1},e))},q=function(e){return r.a.createElement(M,Object.assign({isRegisterForm:!0},e))};console.log("production");var A=function(e){return r.a.createElement("div",{className:"App"},r.a.createElement(n.Suspense,null),r.a.createElement(y,null,r.a.createElement(v,null,r.a.createElement(D,null),r.a.createElement(s.c,null,r.a.createElement(s.a,{path:"/login",render:function(e){return r.a.createElement(P,e)}}),r.a.createElement(s.a,{path:"/register",render:function(e){return r.a.createElement(q,e)}}),r.a.createElement(T,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(B.a,null,r.a.createElement(A,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[37,1,2]]]);
//# sourceMappingURL=main.128b517d.chunk.js.map